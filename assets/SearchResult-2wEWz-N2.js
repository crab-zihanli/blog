import{l as V,m as W,p as X,q as Z,s as ee,v as se,x as ae,r as R,a as C,y as e,z as te,A as re,B as le,R as $,C as oe,D as ie,E as ce,G as ue,H as ne,I as j,J as I,K as de,L as ve,M as Ee,b as he,N as me,O as pe,P as ye,Q as Ae,S as M,T as ge,U as H}from"./app-BvUc2v46.js";const Be=["/","/intro.html","/map.html","/resource.html","/code/","/posts/","/code/ai/","/code/frontend/","/posts/read/","/posts/read/%E5%9C%A8%E5%B3%A1%E6%B1%9F%E7%9A%84%E8%BD%AC%E5%BC%AF%E5%A4%84.html","/posts/read/%E5%A5%87%E9%A3%8E%E5%B0%91%E5%B9%B4.html","/posts/read/%E7%8A%B9%E5%A4%A7%E4%B9%8B%E7%AA%97.html","/posts/think/","/posts/think/%E6%88%91%E7%9A%84%E5%BF%AB%E4%B9%90%E6%97%B6%E4%BB%A3.html","/posts/think/%E6%9F%A5%E6%89%BE%E6%96%87%E7%8C%AE%E7%9A%84%E6%80%9D%E8%B7%AF.html","/code/frontend/css%E6%A0%B7%E5%BC%8F/","/code/frontend/css%E6%A0%B7%E5%BC%8F/scss%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%89%E8%A3%85.html","/code/frontend/javascript%E5%9F%BA%E7%A1%80/ES6%E6%A8%A1%E5%9D%97%E5%8C%96%E8%A7%84%E8%8C%83.html","/code/frontend/javascript%E5%9F%BA%E7%A1%80/","/code/frontend/vuepress%E9%83%A8%E7%BD%B2/vuepress%E9%83%A8%E7%BD%B2.html","/code/frontend/vuepress%E9%83%A8%E7%BD%B2/%E4%BF%AE%E6%94%B9md%E7%B2%98%E8%B4%B4%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84.html","/code/frontend/vuepress%E9%83%A8%E7%BD%B2/%E6%89%8B%E5%86%99%E8%87%AA%E5%8A%A8%E6%92%AD%E6%94%BE%E8%BD%AE%E6%92%AD%E5%9B%BE.html","/404.html","/code/frontend/vuepress%E9%83%A8%E7%BD%B2/","/category/","/category/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/","/category/music/","/category/essay/","/category/research/","/category/coding/","/category/frontend/","/category/css/","/category/js/","/category/vuepress/","/tag/","/tag/%E4%BC%A0%E8%AE%B0/","/tag/%E6%88%90%E9%95%BF/","/tag/%E6%82%AC%E7%96%91/","/tag/%E5%86%92%E9%99%A9/","/tag/%E6%8E%A8%E7%90%86/","/tag/eason/","/tag/paper/","/tag/learn/","/tag/sass/","/tag/ecmascript/","/tag/modules/","/tag/git/","/tag/workflow/","/tag/markdown/","/tag/vscode/","/tag/vue/","/tag/js/","/article/","/star/","/timeline/"],fe="SLIMSEARCH_QUERY_HISTORY",y=M(fe,[]),Ce=()=>{const{queryHistoryCount:r}=H;return{enabled:r>0,queryHistories:y,addQueryHistory:c=>{y.value=Array.from(new Set([c,...y.value.slice(0,r-1)]))},removeQueryHistory:c=>{y.value=[...y.value.slice(0,c),...y.value.slice(c+1)]}}},S=r=>Be[r.id]+("anchor"in r?`#${r.anchor}`:""),He="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:T}=H,A=M(He,[]),ke=()=>({enabled:T>0,resultHistories:A,addResultHistory:i=>{{const c={link:S(i),display:i.display};"header"in i&&(c.header=i.header),A.value=[c,...A.value.slice(0,T-1)]}},removeResultHistory:i=>{A.value=[...A.value.slice(0,i),...A.value.slice(i+1)]}}),De=r=>{const{page:i,routeLocale:c}=de(),k=ve(),l=R(0),g=C(()=>l.value>0),d=Ee([]);return he(()=>{const{search:D,terminate:h}=me(),B=ye(m=>{const{resultsFilter:F=t=>t,querySplitter:p,suggestionsFilter:b,...o}=k.value;m?(l.value+=1,D(m,c.value,o).then(t=>F(t,m,c.value,i.value)).then(t=>{l.value-=1,d.value=t}).catch(t=>{console.warn(t),l.value-=1,l.value||(d.value=[])})):d.value=[]},H.searchDelay-H.suggestDelay,{maxWait:5e3});pe([r,c],([m])=>B(m.join(" "))),Ae(()=>{h()})}),{isSearching:g,results:d}};var we=V({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(r,{emit:i}){const c=W(),k=X(),l=Z(ee),{addQueryHistory:g,queryHistories:d,removeQueryHistory:D}=Ce(),{resultHistories:h,addResultHistory:B,removeResultHistory:m}=ke(),F=se(r,"queries"),{results:p,isSearching:b}=De(F),o=ae({isQuery:!0,index:0}),t=R(0),v=R(0),q=C(()=>d.value.length>0||h.value.length>0),w=C(()=>p.value.length>0),x=C(()=>p.value[t.value]||null),U=()=>{const{isQuery:s,index:a}=o;a===0?(o.isQuery=!s,o.index=s?h.value.length-1:d.value.length-1):o.index=a-1},O=()=>{const{isQuery:s,index:a}=o;a===(s?d.value.length-1:h.value.length-1)?(o.isQuery=!s,o.index=0):o.index=a+1},P=()=>{t.value=t.value>0?t.value-1:p.value.length-1,v.value=x.value.contents.length-1},_=()=>{t.value=t.value<p.value.length-1?t.value+1:0,v.value=0},Y=()=>{v.value<x.value.contents.length-1?v.value+=1:_()},z=()=>{v.value>0?v.value-=1:P()},Q=s=>s.map(a=>ge(a)?a:e(a[0],a[1])),G=s=>{if(s.type==="customField"){const a=ue[s.index]||"$content",[E,u=""]=ne(a)?a[k.value].split("$content"):a.split("$content");return s.display.map(n=>e("div",Q([E,...n,u])))}return s.display.map(a=>e("div",Q(a)))},f=()=>{t.value=0,v.value=0,i("updateQuery",""),i("close")},J=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},l.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},d.value.map((s,a)=>{const E=o.isQuery&&o.index===a;return e("li",{class:["slimsearch-record-matches",{active:E}],role:"option","aria-selected":E,onClick:()=>{i("updateQuery",s)}},e("div",[e(j,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},s),e("button",{type:"button",class:"slimsearch-remove-icon",title:l.value.remove,"aria-label":l.value.remove,innerHTML:I,onClick:u=>{u.preventDefault(),u.stopPropagation(),D(a)}})]))}))])),K=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},l.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},h.value.map((s,a)=>{const E=!o.isQuery&&o.index===a;return e("li",{class:["slimsearch-record-matches",{active:E}],role:"option","aria-selected":E},e($,{to:s.link,onClick:()=>{f()}},()=>[e(j,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[s.header?e("div",{class:"slimsearch-record-content-header"},s.header):null,e("div",s.display.map(u=>Q(u)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:l.value.remove,"aria-label":l.value.remove,innerHTML:I,onClick:u=>{u.preventDefault(),u.stopPropagation(),m(a)}})]))}))]));return te("keydown",s=>{if(r.isFocusing){if(w.value){if(s.key==="ArrowUp")z();else if(s.key==="ArrowDown")Y();else if(s.key==="Enter"){const a=x.value.contents[v.value];g(r.queries.join(" ")),B(a),c.push(S(a)),f()}}else if(s.key==="ArrowUp")U();else if(s.key==="ArrowDown")O();else if(s.key==="Enter"){const{index:a}=o;o.isQuery?(s.preventDefault(),i("updateQuery",d.value[a])):(c.push(h.value[a].link),f())}}}),re([t,v],()=>{var s;(s=document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active"))==null||s.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:r.queries.length?!w.value:!q.value}]},r.queries.length?b.value?e(le,{hint:l.value.searching}):w.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},p.value.map(({title:s,contents:a},E)=>{const u=t.value===E;return e("div",{class:["slimsearch-record",{active:u}],role:"group","aria-selected":u},[e("div",{class:"slimsearch-record-title"},s||l.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},a.map((n,N)=>{const L=u&&v.value===N;return e("li",{class:["slimsearch-record-matches",{active:L}],role:"option","aria-selected":L},e($,{to:S(n),onClick:()=>{g(r.queries.join(" ")),B(n),f()}},()=>[n.type==="text"?null:e(n.type==="title"?oe:n.type==="heading"?ie:ce,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[n.type==="text"&&n.header?e("div",{class:"slimsearch-record-content-header"},n.header):null,e("div",G(n))])]))}))])})):l.value.emptyResult:q.value?[J(),K()]:l.value.emptyHistory)}});export{we as default};
